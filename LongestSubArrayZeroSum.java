/*
 * Problem Description
    Given an array A of N integers.
    Find the length of the longest subarray in the array which sums to zero.
    If there is no subarray which sums to zero then return 0.

    Problem Constraints
    1 <= N <= 105
    -109 <= A[i] <= 109
 */

import java.util.HashMap;
public class LongestSubArrayZeroSum {
    public int solve(int[] A) {
        int n = A.length;
        int maxLength = 0;
        int sum = 0;
        HashMap<Integer, Integer> map = new HashMap<>();

        for (int i = 0; i < n; i++) {
            sum += A[i];

            if (sum == 0) {
                maxLength = i + 1;
            } else if (map.containsKey(sum)) {
                maxLength = Math.max(maxLength, i - map.get(sum));
            } else {
                map.put(sum, i);
            }
        }

        return maxLength;
    }
    public static void main(String[] args) {
        LongestSubArrayZeroSum obj = new LongestSubArrayZeroSum();
        int[] A = {742831360, -165426725, -306748400, -928127987, -265263719, -936378391, 937163245, 396511526, -137054984, -351250457, 999599587, -263816220, -620262399, 41442062, -962249780, -82782412, -39712851, -963574311, -375460838, -782976165, 39850458, 109761980, -476599166, 114035884, -86715654, -805464991, 272284129, 704918354, 910182399, 976284090, 943510433, 326748560, -622076071, -290748904, 458228672, 434084350, 220887779, 309897728, 992353123, -721502423, -926079766, 260733716, 809763051, 246895595, -735401699, 451804779, -535443779, 351532576, -919800895, 188759638, 144761286, -571368152, 749746055, 429684681, 462761061, 618255709, -297367591, -634918828, -429593849, 591277985, -71632236, -866177058, -141185193, -815184544, 216990171, -921295931, 355043086, 284316219, -622222065, -35674868, 299040849, -656835619, 144575920, -699439173, -358731320, 281506140, 578540866, -841258629, 293864227, 335478414, -606736712, 875002589, 606650603, 853650287, -28492640, -169597921, -814507321, -73524181, 65013141, -824055565, -392666220, -88466185, -261297663, 250680399, 255715104, 874713421, 758106615, 984905906, 336721351, 256057804, 858151069, 762387691, -796477818, 530725484, -609736659, 628950207, -899245387, -885126327, -830153312, -583441254, -825362283, -451954431, 833394591, -675973003, 820303767, -607834975, 784245227, 690490223, 886239079, -527537606, 792250414, -682220903, 182796427, 589909343, 85710020, 747537680, 418863911, -113593112, -614742402, 504582009, -283811804, -520254628, -76315360, 730763274, 878896680, 753920402, -506890807, 673029447, -698903575, 266021007, -111339026, -144452170, 578044304, 552088173, 617178229, 290228811, -872349793, 335177053, 871802275, -413679227, 176132578, -45407640, -67406093, 862915417, -651196218, 470397496, -855351434, 243945833, 743498878, -713429566, 950338514, 3708791, -996353393, 968116908, 750228254, -839761702, 942667228, -385745339, -134311268, 278251287, -209828369, 665312671, -911078353, 5392772, -33471086, -58993998, 616727945, -977232441, -236639337, 618780960, 607503733, -924467620, -666237309, 204540457, 165954053, 830466825, -243366633, 446722980, -506460964, -732091961, 68306048, -61800536, -439167103, -969141724, -636898711, -150946318, 264425497, -536341760, 370571580, -11168180, -719087687, 822816438, -894424074, 651689673, -590604805, -372917850, 588838728, -932863616, -739173824, -9699689, -244619202, 270820426, 863357126, -762873453, -461569692, 756178501, 368932901, -342694365, 747968823, -339502595, -135074231, 421033871, 695601823, 689309979, 96892982, 482538055, -997608585, 788217753, 259442729, 588250503, -399790166, -405786481, -289313364, -932111617, -717869193, -574827073, 619197843, 80534029, -966776984, -629992556, 418350152, -420357217, 172443692, -333231217, 965109358, -220750791, -324377597, 510004963, 780846980, 173084036, -769696485, -973348597, -648645401, 49289286, -157453075, 681708632, 334670107, 32890887, 169473261, -134592298, -603135542, 664362836, 624896788, -392870799, 456576498, 464930582, 903970870, 736085522, 437663713, -777643278, -94342123, -934102308, -327804392, 269401010, -64555912, -281300919, 132067023, -602284661, -598411487, -213478265, 144097117, 698426239, -170402640, 110683708, 664296564, -309927011, -110177473, -395384800, 716126095, 506696306, 628208164, 752404264, -703516618, -168895853, -685559551, 886597623, -870497086, -198336227, 856843300, 924238209, 138478286, -905620106, 488503160, 654256371, 282069582, 482562881, 588412338, -830003047, -671753162, 165712630, 807778577, -853552141, 131280885, 535471977, 329676264, -36343793, 86895289, 741264342, 205627759, 979044327, 193542443, -62162883, 735865561, -269637066, -165134858, 371414139, -951246435, -394171962, 49433412, -813053299, -117175885, -811554771, -568934908, -705450288, -866599058, 262120329, -107132152, -740645411, -3507391, -317722246, 264641352, 522946711, -15355809, 969108180, -953845900, 550546155, -427841878, -321463027, -599358463, 25099922, -965534164, -116988065, 138818132, -920066292, -672725712, 136688139, -100514963, -28145439, 49823608, -707229545, -609646312, -865711974, -364627738, 714869178, 437502725, 678505145, 869757037, 547554584, -902956671, -823694691, 935345572, 666454441, -477197917, 21830666, -785507493, 55496028, 996462003, -333595570, 788844741, -379334905, 230186214, -194231682, -960780515, 595806968, -29172222, -32560508, -543327707, -643512908, 894954428, 464062802, 56010325, 543237241, -342225841, 277698494, -569635607, 725981611, 253005479, -115596463, -341846971, 455836688, -583033316, 477794032, -491245050, -728994057, -789891206, 598552340, -518292097, 52731456, -920621748, 546955784, -689716103, 473525815, 501835121, -241754151, 152655196, -853418850, -987309708, -534892484, -84117285, -882936020, 647683713, 812110424, 882509887, -287093510, -8963794, -316302985, -546471059, 471275214, -600621077, 175533778, -642832653, 826227915, -609243834, -682429268, 879067083, 350677753, 311846782, -229984700, -154373310, 79658510, 453833632, 536855377, -957397706, -788470072, -317095118, -637920930, 451747804, 235588216, -522533411, -443346795, -900950977, -496237866, -225523971, 609164888, -223703172, 166798643, 5243500, -904421117, -54368655, -866362901, 48296775, 875982509, 398044179, 365308671, 181854664, -291268050, -289263783, -326548223, 335284681, -749951139, -639327440, -420631329, -75171016, 360822760, 133831159, -71362120, 533482913, 87371538, 753049764, 927214710, 571770560, 38662005, -542257876, 742339876, -555397088, 352028071, -344317847, -461320147, 625388468, -641182112, 478234982, -809009207, -419786452, -940683134, -285767326, 359206765, 141398109, -27096403, -614758424, -6846429, -67669266, 914450723, -600944124, -121675008, 691453699, -615859223, 322595872, 28290210, -700987917, 336264430, 615159042, 789920691, 619099485, 436468574, 727135931, -56069577, 529393239, -822668020, -931764937, -993522648, -778451171, -615037120, -595489230, -354570697, 13449368, 906434441, 6142098, 876977412, -6868531, 638187405, 908277653, 612908020, 362039341, -670108649, 647174928, 640011599, -464271121, -997589157, -892929485, -870152102, 213854651, 212621030, 100912366, -991023019, 499098329, 979986525, -672465113, -123773734, -133062173, -30746710, -376744573, -258806969, 313320308, -207359517, 917847065, 331277523, -531011359, -28864596, -277593110, 108497521, 779903820, 411805177, -526781855, -244033614, -949801643, -553476086, 747367541, 412866356, 507556859, 287728946, 976867305, -177481356, 695579008, 226654424, 625922697, 439100227, 347779550, 493648866, 232513271, -712817813, -244729348, -913931982, 37001157, 4151704, 821813364, 360883762, -495638660, 991845316, -254443659, 256050374, -599092374, 953522798, -948163144, 979396475, 120110223, 715844064, -514013925, -292817787, -446148512, -595163588, 586698744, -569529929, -9645539, -147831123, -854807012, -152539055, 733817676, 191874969, 212387992, -180414976, -848562052, -200914936, -742543806, -227525601, 644830656, -122163208, -649024698, -8959018, 664306324, 767510733, -397154572, 351922954, 405244213, 939875586, -704252973, 961213517, -763930519, -233093216, -663935027, 968484773, 297937551, 647184203, -184928786, 10826933, 549708978, -366137680, 792883741, 930680379, -825178315, -211108808, -169012619, 235977337, -665461296, -506653522, -742783948, 207053597, -132312923, -687036830, 233779077, 937998637, -233443504, 128032067, -626125008, -167410086, 37262685, -75652428, -400147403, -4805322, -320530356, -774650994, -955430682, 520873412, -770352974, -440169095, 180829714, 174970020, -436937167, 334765355, -475810220, -850725403, -755009858, -672090491, -751507076, 906176819, 896467871, 828960836, -171061011, -608868869, 33803704, 434651795, -917426061, -452999794, 627426915, -673246633, 429788938, -171282545, -984157025, -926043405, 391208273, -447877476, -43972684, 397061992, 945496840, 241615644, 254508736, -161805049, -933383315, 469031722, 503331579, -752497558, -478516623, -50396177, 380314051, -416030435, -366460336, -207119718, -44829749, 123391324, 512009019, 168748404, 817699015, 500343186, -59268664, -416482052, 721645548, 624631267, -515798367, -447524856, 576380524, -865750644, 868513943, -751258093, -708734185, 139387410, -390034500, 407181606, 322445711, 298907138, -812775650, -984885265, -491157984, 767604398, -857828239, 971013790, 735791564, -158244380, 831142818, 316458188, 940847113, 754803856, 705203776, -294692934, -170016256, -497358568, -723061339, -670038345, 98375857, 245215714, -418541961, 961981990, -332348066, -437061793, 164210357, 343865675, 284688926, 846267282, 83344322, 309891450, 563796981, -325914394, 909699627, -975629857, -639059628, 742475503, 877681378, -886545685, -821896804, -949715462, -371232862, -489480527, 298821953, -498083842, 31732402, 173740944, -348603214, 161105375, -911779819, 455309600, 896797454, 446296820, -506457100, -522655695, -985985272, -803225478, 736905119, 780610503, -789261118, -231390129, -995983992, 378304762, 676502177, 757124494, 139281046, -308916276, 638199558, -395374071, 593099532, 49630001, -157851203, 997009927, 475811228, 797039608, -287250720, 692652132, -754247751, -303194593, 480726621, -393686972, -168838190, -531696872, 968863480, -142538193, -857508694, 489317637, -8633044, 10851499, -67960982, -662640114, 582260308, 882639432, -109316818, -194940572, -90256667, 230846617, 986196829, -407642005, -523123703, -666891974, 128122374, -885548298, 502894826, 415738861, 170933787, -704144157, 303301001, 226489055, 506696965, 44440766, -72540492, -936359730, 766319745, -641416548, 843778975, 809427287, 472285994, 937711922, 173824451, 696318157, -61692138, -344595659, 530824904, -982652272, 313160154, 923396044, -986425111, 353051286, 815324902, 298422702, 300457348, 408581646, -607744485, -418115250, 354016957, -789088556, -199457308, -505661817, -942816873, 682425917, -890823465, -410893171, -644907409, 713941922, 199008171, 139045604, 400933677, 40975593,
            -768842097, -604607633, -876074764, 705008406, 233382334, 98189619, 251844741, -802168112, -282415393, -406390933, 340916135, -96982367, -17131731, 809598724, 439079751, 813582742, -223748200, -532905219, -813167006, 870125865, -136324153, 291260254, 795777569, 521351441, 113791202, -137890557, -216226038, -428204752, -370756915, -423865399, 706540363, 391581214, 815691006, 145909391, 39809261, 900016690, -90290796, 226304189, 143509237, -802593022, -851688353, 104583113, -488145054, -534922395, 470843376, 450384385, 641926017, -270096735, 169495668, -54116739, -769535989, -345459751, -356909738, 844637369, -190033239, -316555480, -88242034, -401905590, -673820705, 589422468, -697907069, -754131829, 803064563, -955297873, -189815294, 191233682, -801573628, 371832901, 982598482, -396852131, 214616587, 608511147, -28927440, -378237348, -892723100, -7456930, -554411610, -936822070, 260640208, -446544606, -769595942, 617074152, 898167258, -722977903, 203853311};
        System.out.println(obj.solve(A)); // Output: 6
    }
}